<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@6.1.11/index.global.min.js"></script>

<style>
:root{
  --bg:#0b0f14;
  --panel:#111827;
  --panel2:#0f172a;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --border:#1f2937;
  --btn:#1f2937;

  --fc-page-bg-color-a:#0b0f14;
  --fc-page-bg-color-b:#0e1420;
  --fc-border-color:#1f2937;
  --fc-neutral-text-color:#e5e7eb;
  --fc-event-text-color:#ffffff;
  --fc-event-border-color:#0b0f14;
  --fc-today-bg-color:rgba(255,220,40,.35);
}

html,body{
  height:100%;
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
}

.main{
  height:100vh;
  padding:10px;
  box-sizing:border-box;
}

#calendar{
  height:100%;
}

/* ===== FullCalendar ===== */
.fc{
  background:transparent;
  border-radius:14px;
  overflow:hidden;
}

.fc-theme-standard td,
.fc-theme-standard th,
.fc-theme-standard .fc-scrollgrid{
  border-color:var(--fc-border-color)!important;
}

/* 日付タイトルを完全に消す */
.fc .fc-toolbar-title{
  display:none!important;
}

/* ヘッダーは settings だけ残す */
.fc .fc-toolbar{
  margin:0 0 6px!important;
}
.fc .fc-toolbar-chunk:not(:last-child){
  display:none!important;
}
.fc .fc-toolbar-chunk:last-child .fc-button:not(.fc-settings-button){
  display:none!important;
}

/* 設定ボタンを目立たなく */
.fc .fc-settings-button{
  background:var(--fc-page-bg-color-a)!important;
  border-color:var(--fc-page-bg-color-a)!important;
  color:var(--muted)!important;
  padding:6px 9px!important;
  border-radius:12px!important;
  box-shadow:none!important;
  opacity:.7;
}
.fc .fc-settings-button:hover{
  opacity:.9;
}

/* 曜日・軸文字 */
.fc .fc-col-header-cell-cushion,
.fc .fc-timegrid-axis-cushion{
  color:var(--fc-neutral-text-color)!important;
}

/* イベント */
.fc .fc-event{
  color:var(--fc-event-text-color)!important;
  border:1px solid var(--fc-event-border-color)!important;
  box-shadow:none!important;
}

/* 今日 */
.fc .fc-day-today,
.fc .fc-timegrid-col.fc-day-today{
  background:var(--fc-today-bg-color)!important;
}

/* 交互背景 */
.fc .fc-timegrid-col:nth-child(odd),
.fc .fc-daygrid-day:nth-child(odd){
  background:var(--fc-page-bg-color-a)!important;
}
.fc .fc-timegrid-col:nth-child(even),
.fc .fc-daygrid-day:nth-child(even){
  background:var(--fc-page-bg-color-b)!important;
}

/* ===== Drawer ===== */
.overlay{
  position:fixed; inset:0;
  background:rgba(0,0,0,.35);
  display:none;
  z-index:10;
}
.overlay.on{display:block;}

.drawer{
  position:fixed;
  top:0; right:0;
  width:420px;
  max-width:90vw;
  height:100vh;
  background:linear-gradient(180deg,var(--panel),var(--panel2));
  border-left:1px solid var(--border);
  padding:14px;
  box-sizing:border-box;
  transform:translateX(110%);
  transition:transform .2s;
  z-index:11;
  overflow:auto;
}
.drawer.open{transform:none;}

h1{font-size:16px;margin:0 0 10px;}
.small{font-size:12px;color:var(--muted);}

.card{
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px;
  margin:10px 0;
}

.btn{
  background:var(--btn);
  border:1px solid var(--border);
  color:var(--text);
  padding:6px 10px;
  border-radius:10px;
  cursor:pointer;
  font-size:12px;
}

label{font-size:12px;color:var(--muted);}
select{
  width:100%;
  margin-top:4px;
  background:#0b1220;
  color:var(--text);
  border:1px solid var(--border);
  padding:6px 8px;
  border-radius:10px;
}
</style>
</head>

<body>
<div class="overlay" id="overlay"></div>

<main class="main">
  <div id="calendar"></div>
</main>

<aside class="drawer" id="drawer">
  <h1>設定</h1>

  <div class="card">
    <label>曜日の表示</label>
    <select id="weekdayLang">
      <option value="ja">日本語（月・火・水）</option>
      <option value="en">English (Mon, Tue)</option>
    </select>
  </div>

  <button class="btn" id="btnClose">閉じる</button>
</aside>

<script>
const GOOGLE_API_KEY = "AIzaSyDZdH26P0tSEBRNnEa4rE9As7rcd924QJ4";
const LS_LANG = "mycalendar.weekday.lang";

const $ = id => document.getElementById(id);

let calendar;

function buildCalendar(){
  const lang = localStorage.getItem(LS_LANG) || "ja";

  if(calendar){
    calendar.destroy();
  }

  calendar = new FullCalendar.Calendar($("calendar"),{
    initialView:"timeGridWeek",
    firstDay:1,
    height:"100%",
    locale: lang === "ja" ? "ja" : "en",
    googleCalendarApiKey: GOOGLE_API_KEY,

    headerToolbar:{
      left:"",
      center:"",
      right:"settings"
    },

    customButtons:{
      settings:{
        text:"⚙",
        click:()=>{
          $("drawer").classList.add("open");
          $("overlay").classList.add("on");
        }
      }
    }
  });

  calendar.render();
}

document.addEventListener("DOMContentLoaded",()=>{
  $("weekdayLang").value = localStorage.getItem(LS_LANG) || "ja";

  $("weekdayLang").addEventListener("change",e=>{
    localStorage.setItem(LS_LANG,e.target.value);
    buildCalendar();
  });

  $("btnClose").onclick = ()=>{
    $("drawer").classList.remove("open");
    $("overlay").classList.remove("on");
  };
  $("overlay").onclick = $("btnClose").onclick;

  buildCalendar();
});
</script>
</body>
</html>
